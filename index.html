<!DOCTYPE html> 
<html>

<head>
	<title>Chorded Keypad</title> 
	<meta charset="utf-8">
	<meta name="apple-mobile-web-app-capable" content="yes">
 	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="viewport" content="width=device-width, user-scalable=no" />
	<link rel="stylesheet" href="css/style.css" />
	<link rel="apple-touch-icon" href="appicon.png" />
	<link rel="apple-touch-startup-image" href="startup.png">

	<script src="js/jquery-1.8.2.min.js"></script>
	<link rel="stylesheet" href="css/jquery.mobile-1.2.0.css" />
	
</head>

<body>

<canvas id="content"></canvas>

<div id="key"></div>

<div id="space">space</div>
<div id="clear">clear</div>
<div id="backspace">delete</div>

<div class="chorded">
	<div class="a box 0" id="16"></div>
	<div class="b box 1" id="8"></div>
	<div class="c box 2" id="4"></div>
	<div class="d box 3" id="2"></div>
	<div class="e box 4" id="1"></div>
</div>

<script type="text/javascript">
$("#clear").click(function () {
    $("#key").html("");
});
$("#backspace").click(function () {
	str = $("#key").html();
    $("#key").html(str.substring(0, str.length - 1));
});
$("#space").click(function () {
	str = $("#key").html();
    $("#key").html(str + " ");
});
Array.prototype.unique = function () {
    var o = {}, i, l = this.length,
        r = [];
    for (i = 0; i < l; i += 1) o[this[i]] = this[i];
    for (i in o) r.push(o[i]);
    return r;
};
var canvas;
var allInts = new Array();
var mouseDown;
var touchstart = 'mousedown';
var touchmove = 'mousemove';
var touchend = 'mouseup';

if ('ontouchstart' in window) {
    touchstart = 'touchstart';
    touchmove = 'touchmove';
    touchend = 'touchend';
}
var total = 0;
$(document).ready(function () {
    canvas = document.getElementById('content');
    canvas.width = document.body.clientWidth;
    canvas.height = document.body.clientHeight;
    ctx = canvas.getContext('2d');
   
    document.body.addEventListener(touchend, function (e) {
        $(".box").removeClass("selected");

        allInts.unique().forEach(function (entry) {
            total += entry;
        });
        if (total > 0) {
	        var stri = String.fromCharCode(parseInt(96 + total));
	        $("#key").append(stri);
        }
        allInts = new Array();
        total = 0;
    });

canvas.addEventListener(touchstart, function (e) {
        if (e) {
            e.preventDefault();
			var myAudio = document.getElementById("myAudio");
			myAudio.play();
            for (var i = 0; i < e.touches.length; i++) {
                var touch = e.touches[i];
                allInts.push(parseInt($("." + Math.round((touch.pageY) / 95)).attr("id")));
                $("." + Math.round((touch.pageY) / 95)).addClass("selected");
            }
        } else {
            mouseDown = true;
            $("#key").append(Math.round(e.pageY / 85));
        }

    });
   
});
</script>
<audio id="myAudio">
<source src="click.mp3" type="audio/mpeg" />
</audio>
</body>
</html>